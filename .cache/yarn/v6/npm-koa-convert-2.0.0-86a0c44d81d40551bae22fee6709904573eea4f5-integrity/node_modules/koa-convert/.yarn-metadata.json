{
  "manifest": {
    "name": "koa-convert",
    "version": "2.0.0",
    "description": "convert modern Koa legacy generator-based middleware to promise-based middleware",
    "main": "index.js",
    "files": [
      "index.js"
    ],
    "repository": {
      "type": "git",
      "url": "git+https://github.com/gyson/koa-convert.git"
    },
    "standard": {
      "ignore": [
        "index.spec.js"
      ]
    },
    "scripts": {
      "lint": "standard",
      "pretest": "npm run lint",
      "test": "mocha index.spec.js --exit",
      "precoverage": "rimraf .nyc_output coverage",
      "coverage": "nyc npm run test",
      "ci": "npm run coverage"
    },
    "keywords": [
      "koa",
      "middleware",
      "convert",
      "back",
      "generator",
      "promise",
      "generator-based-middleware",
      "promise-based-middleware",
      "support"
    ],
    "author": {
      "name": "gyson",
      "email": "eilian.yunsong@gmail.com"
    },
    "contributors": [
      {
        "name": "gyson",
        "email": "eilian.yunsong@gmail.com"
      },
      {
        "name": "Lloyd Brookes",
        "email": "75pound@gmail.com"
      },
      {
        "name": "Imed Jaberi",
        "email": "imed-jaberi@outlook.com",
        "url": "https://www.3imed-jaberi.com"
      }
    ],
    "license": "MIT",
    "dependencies": {
      "co": "^4.6.0",
      "koa-compose": "^4.1.0"
    },
    "devDependencies": {
      "koa": "^2.13.0",
      "koa-v1": "npm:koa@1.7.0",
      "mocha": "^7.1.1",
      "nyc": "^15.1.0",
      "rimraf": "^3.0.2",
      "standard": "^14.3.4",
      "supertest": "^4.0.2"
    },
    "engines": {
      "node": ">= 10"
    },
    "bugs": {
      "url": "https://github.com/gyson/koa-convert/issues"
    },
    "homepage": "https://github.com/gyson/koa-convert#readme",
    "_registry": "npm",
    "_loc": "/home/ubuntu/.cache/yarn/v6/npm-koa-convert-2.0.0-86a0c44d81d40551bae22fee6709904573eea4f5-integrity/node_modules/koa-convert/package.json",
    "readmeFilename": "README.md",
    "readme": "# koa-convert\n\n[![Build Status][travis-img]][travis-url]\n[![NPM version][npm-badge]][npm-url]\n[![License][license-badge]][license-url]\n![Code Size][code-size-badge]\n\n<!-- [![Coverage Status][coverage-img]][coverage-url] -->\n\n<!-- ***************** -->\n\n[travis-img]: https://travis-ci.org/koajs/convert.svg?branch=master\n[travis-url]: https://travis-ci.org/koajs/convert\n\n<!-- \n  WAIT FOR ACCESS \n  [coverage-img]: https://coveralls.io/repos/github/koajs/convert/badge.svg?branch=master\n  [coverage-url]: https://coveralls.io/github/koajs/convert?branch=master\n-->\n\n[npm-badge]: https://img.shields.io/npm/v/koa-better-request-id.svg?style=flat\n[npm-url]: https://www.npmjs.com/package/koa-better-request-id\n[license-badge]: https://img.shields.io/badge/license-MIT-green.svg?style=flat-square\n[license-url]: https://github.com/koajs/koa-convert/blob/master/LICENSE\n[code-size-badge]: https://img.shields.io/github/languages/code-size/koajs/koa-convert\n\n<!-- ***************** -->\n\nConvert Koa legacy (0.x & 1.x) generator middleware to modern promise middleware (2.x).\n\nIt could also convert modern promise middleware back to legacy generator middleware (useful to help modern middleware support Koa v0.x or v1.x).\n\n## Note\n\nRouter middleware is special case here. Because it reimplements middleware composition internally, we cannot not simply convert it.\n\nYou may use following packages for [routing](https://github.com/koajs/koa/wiki#routing-and-mounting), which are koa 2.x ready now:\n\n* [koa-route@3.0.0](https://github.com/koajs/route/tree/next)\n* [koa-simple-router](https://github.com/gyson/koa-simple-router)\n* [koa-router@next](https://github.com/alexmingoia/koa-router/tree/master)\n* [koa-66](https://github.com/menems/koa-66)\n\n## Installation\n\n```bash\n# npm ..\n$ npm i koa-convert\n# yarn ..\n$ yarn add koa-convert\n```\n\n## Usage\n\n```js\nconst Koa = require('koa') // koa v2.x\nconst convert = require('koa-convert')\nconst app = new Koa()\n\napp.use(modernMiddleware)\n\napp.use(convert(legacyMiddleware))\n\napp.use(convert.compose(legacyMiddleware, modernMiddleware))\n\nfunction * legacyMiddleware (next) {\n  // before\n  yield next\n  // after\n}\n\nfunction modernMiddleware (ctx, next) {\n  // before\n  return next().then(() => {\n    // after\n  })\n}\n```\n\n## Distinguish legacy and modern middleware\n\nIn koa 0.x and 1.x (without experimental flag), `app.use` has an assertion that all (legacy) middleware must be generator function and it's tested with `fn.constructor.name == 'GeneratorFunction'` at [here](https://github.com/koajs/koa/blob/7fe29d92f1e826d9ce36029e1b9263b94cba8a7c/lib/application.js#L105).\n\nTherefore, we can distinguish legacy and modern middleware with `fn.constructor.name == 'GeneratorFunction'`.\n\n## Migration\n\n`app.use(legacyMiddleware)` is everywhere in 0.x and 1.x and it would be painful to manually change all of them to `app.use(convert(legacyMiddleware))`.\n\nYou can use following snippet to make migration easier.\n\n```js\nconst _use = app.use\napp.use = x => _use.call(app, convert(x))\n```\n\nThe above snippet will override `app.use` method and implicitly convert all legacy generator middleware to modern promise middleware.\n\nTherefore, you can have both `app.use(modernMiddleware)` and `app.use(legacyMiddleware)` and your 0.x or 1.x should work without modification.\n\nComplete example:\n\n```js\nconst Koa = require('koa') // v2.x\nconst convert = require('koa-convert')\nconst app = new Koa()\n\n// ---------- override app.use method ----------\n\nconst _use = app.use\napp.use = x => _use.call(app, convert(x))\n\n// ---------- end ----------\n\napp.use(modernMiddleware)\n\n// this will be converted to modern promise middleware implicitly\napp.use(legacyMiddleware)\n\nfunction * legacyMiddleware (next) {\n  // before\n  yield next\n  // after\n}\n\nfunction modernMiddleware (ctx, next) {\n  // before\n  return next().then(() => {\n    // after\n  })\n}\n```\n\n## API\n\n#### `convert()`\n\nConvert legacy generator middleware to modern promise middleware.\n\n```js\nmodernMiddleware = convert(legacyMiddleware)\n```\n\n#### `convert.compose()`\n\nConvert and compose multiple middleware (could mix legacy and modern ones) and return modern promise middleware.\n\n```js\ncomposedModernMiddleware = convert.compose(legacyMiddleware, modernMiddleware)\n// or\ncomposedModernMiddleware = convert.compose([legacyMiddleware, modernMiddleware])\n```\n\n#### `convert.back()`\n\nConvert modern promise middleware back to legacy generator middleware.\n\nThis is useful to help modern promise middleware support koa 0.x or 1.x.\n\n```js\nlegacyMiddleware = convert.back(modernMiddleware)\n```\n\n## License\n\n[MIT](LICENSE)\n",
    "licenseText": "The MIT License (MIT)\n\nCopyright (c) 2015 yunsong\nCopyright (c) 2020 Koa.js contributors\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all\ncopies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n"
  },
  "artifacts": [],
  "remote": {
    "resolved": "https://registry.yarnpkg.com/koa-convert/-/koa-convert-2.0.0.tgz#86a0c44d81d40551bae22fee6709904573eea4f5",
    "type": "tarball",
    "reference": "https://registry.yarnpkg.com/koa-convert/-/koa-convert-2.0.0.tgz",
    "hash": "86a0c44d81d40551bae22fee6709904573eea4f5",
    "integrity": "sha512-asOvN6bFlSnxewce2e/DK3p4tltyfC4VM7ZwuTuepI7dEQVcvpyFuBcEARu1+Hxg8DIwytce2n7jrZtRlPrARA==",
    "registry": "npm",
    "packageName": "koa-convert",
    "cacheIntegrity": "sha512-asOvN6bFlSnxewce2e/DK3p4tltyfC4VM7ZwuTuepI7dEQVcvpyFuBcEARu1+Hxg8DIwytce2n7jrZtRlPrARA== sha1-hqDETYHUBVG64i/uZwmQRXPupPU="
  },
  "registry": "npm",
  "hash": "86a0c44d81d40551bae22fee6709904573eea4f5"
}